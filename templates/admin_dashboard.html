{% extends 'base.html' %}
{% block content %}
  <h4>Admin Dashboard</h4>
  <h5>Pending Requests</h5>
  {% if pending %}
  <table class="table">
    <thead><tr><th>ID</th><th>Household</th><th>Location</th><th>Action</th></tr></thead>
    <tbody>
      {% for p in pending %}
      <tr>
        <td>{{ p.id }}</td>
        <td>{{ p.household.username }}</td>
        <td>{{ p.location }}</td>
        <td>
          <form method="post" action="{{ url_for('approve_pickup', pid=p.id) }}" style="display:inline;">
            <button class="btn btn-sm btn-success">Approve</button>
          </form>
          <a class="btn btn-sm btn-info" href="{{ url_for('pickup_detail', pid=p.id) }}">View</a>
          <form method="post" action="{{ url_for('assign_pickup', pid=p.id) }}" style="display:inline; margin-left:5px;">
            <select name="staff_id" class="form-select form-select-sm d-inline-block" style="width:auto">
              {% for s in staff_list %}
                <option value="{{ s.id }}">{{ s.name or s.username }}</option>
              {% endfor %}
            </select>
            <button class="btn btn-sm btn-warning">Assign</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No pending requests.</p>
  {% endif %}

  <a class="btn btn-outline-secondary mt-3" href="{{ url_for('admin_export') }}">Export CSV</a>
{% endblock %}
